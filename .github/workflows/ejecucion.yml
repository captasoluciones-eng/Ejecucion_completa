name: EjecuciÃ³n Completa BigQuery

on:
  workflow_dispatch:  # EjecuciÃ³n manual desde GitHub
  schedule:
    - cron: "0 * * * *"  # Cada hora (ajusta segÃºn necesites)

jobs:
  run-scripts:
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“¥ Checkout repository
        uses: actions/checkout@v3
      
      - name: ðŸ Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"
      
      - name: ðŸ“¦ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pandas gdown google-cloud-bigquery db-dtypes pyarrow
      
      - name: ðŸ”‘ Setup GCP credentials
        env:
          GCP_CREDENTIALS: ${{ secrets.GCP_CREDENTIALS }}
        run: |
          echo "$GCP_CREDENTIALS" > $HOME/gcp_credentials.json
          echo "GOOGLE_APPLICATION_CREDENTIALS=$HOME/gcp_credentials.json" >> $GITHUB_ENV
      
      - name: ðŸš€ Ejecutar CreditosActivos10.py
        run: python "CreditosActivos10.py"
      
      - name: ðŸš€ Ejecutar Rentabilidad.py
        run: python "Rentabilidad.py"
      
      - name: ðŸš€ Ejecutar Detallado de Canje.py
        run: python "Detallado de Canje.py"
      
      - name: ðŸš€ Ejecutar Kpis's.py
        run: python "Kpis's.py"

      - name: ðŸš€ Ejecutar EvaluacionFinancieraBitacora.py
        run: python "EvaluacionFinancieraGitHub.py"
      
      - name: ðŸ§¹ Cleanup
        if: always()
        run: |
          rm -f $HOME/gcp_credentials.json
          rm -f *.csv
          echo "âœ… Proceso completado y archivos temporales eliminados"
